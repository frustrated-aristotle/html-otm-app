<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <title></title>
    <meta name="description" content="" />
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC"
      crossorigin="anonymous"
    />
    <!-- <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/css/bootstrap.min.css" integrity="sha384-TX8t27EcRE3e/ihU7zmQxVncDAy5uIKz4rEkgIXeMed4M0jlfIDPvg6uqKI2xXr2" crossorigin="anonymous"> -->
    <!-- <link href="https://cdn.jsdelivr.net/npm/bootstrap@4.1.1/dist/css/bootstrap.min.css" rel="stylesheet" /> -->
    <link
      href="https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css"
      rel="stylesheet"
      integrity="sha384-wvfXpqpZZVQGK6TAh5PVlGOfQNHSoD2xbE+QkPxCAFlNEevoEH3Sl0sibVcOQVnN"
      crossorigin="anonymous"
    />
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css"
    />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link rel="stylesheet" href="" />
    <style>
      .card {
        background-color: #7952b3;
      }
    </style>
  </head>

  <body>
    <section class="vh-100 gradient-custom">
      <div class="container py-5 h-100">
        <div class="row d-flex justify-content-center align-items-center h-100">
          <div class="col-12 col-md-8 col-lg-6 col-xl-5">
            <div class="card text-white" style="border-radius: 1rem">
              <div class="card-body p-5 text-center">
                <div class="mb-md-5 mt-md-4 pb-5">
                  <h2 class="fw-bold mb-2 text-uppercase">Kayıt</h2>
                  <p class="text-white-50 mb-5">Lütfen Tüm Alanları Doldurun</p>
                  <form id="registrationForm">
                    <div
                      data-mdb-input-init
                      class="form-outline form-white mb-4"
                    >
                      <input
                        type="email"
                        id="typeEmailX"
                        class="form-control form-control-lg"
                        placeholder="Email"
                        required
                      />
                    </div>

                    <div
                      data-mdb-input-init
                      class="form-outline form-white mb-4"
                    >
                      <input
                        type="password"
                        id="typePasswordX"
                        class="form-control form-control-lg"
                        placeholder="Şifre"
                        required
                      />
                    </div>

                    <div
                      data-mdb-input-init
                      class="form-outline form-white mb-4"
                    >
                      <input
                        type="text"
                        id="typeNameX"
                        class="form-control form-control-lg"
                        placeholder="Ad"
                        required
                      />
                    </div>

                    <div
                      data-mdb-input-init
                      class="form-outline form-white mb-4"
                    >
                      <input
                        type="text"
                        id="typeSurnameX"
                        class="form-control form-control-lg"
                        placeholder="Soyad"
                        required
                      />
                    </div>

                    <div
                      data-mdb-input-init
                      class="form-outline form-white mb-4"
                    >
                      <input
                        type="text"
                        id="typeUsernameX"
                        class="form-control form-control-lg"
                        placeholder="Kullanıcı Adı"
                        required
                      />
                    </div>

                    <button
                      data-mdb-button-init
                      data-mdb-ripple-init
                      class="btn btn-outline-light btn-lg px-5"
                      id="btnRegister"
                      type="submit"
                    >
                      Kayıtla Bakalım
                    </button>
                  </form>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </section>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>

    <!-- Add Firebase products that you want to use -->
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-auth.js"></script>

    <!-- Add Firestore for database functionality -->
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-firestore.js"></script>

    <script>
      document
        .getElementById("registrationForm")
        .addEventListener("submit", function (event) {
          event.preventDefault(); // Formun varsayılan davranışını engelle

          // Burada kayıt işlemlerini yapabilirsiniz
          register();
        });
      // Your web app's Firebase configuration
      const firebaseConfig = {
        apiKey: "AIzaSyBhJTyPZintjfuPLN-yI6ykNeE48OVrrt4",
        authDomain: "otm-share.firebaseapp.com",
        projectId: "otm-share",
        storageBucket: "otm-share.appspot.com",
        messagingSenderId: "348092862020",
        appId: "1:348092862020:web:ae23c9664f7998b011b611",
        measurementId: "G-MXBLQQQSS3",
      };

      // Initialize Firebase
      firebase.initializeApp(firebaseConfig);
      const db = firebase.firestore();

      // Function to handle registration
      function register() {
        var btnRegister = document.getElementById("btnRegister");
        btnRegister.innerHTML =
          '<div class="spinner-border spinner-border-sm" role="status"><span class="visually-hidden">Loading...</span></div>';
        var email = document.getElementById("typeEmailX").value;
        var password = document.getElementById("typePasswordX").value;
        var name = document.getElementById("typeNameX").value;
        var surname = document.getElementById("typeSurnameX").value;
        var username = document.getElementById("typeUsernameX").value;

        firebase
          .auth()
          .createUserWithEmailAndPassword(email, password)
          .then((userCredential) => {
            // Signed up
            var user = userCredential.user;
            alert("Kayıt başarılı, giriş yapabilirsiniz!");
            localStorage.setItem("uid", user.uid);
            addUser(user.uid);
          })
          .catch((error) => {
            var errorCode = error.code;
            var errorMessage = error.message;
            alert(errorMessage);
            btnRegister.innerHTML = "Kayıtla Bakalım";
            // Handle errors here
          });
      }
      function addUser(uid) {
        const email = document.getElementById("typeEmailX").value;
        const name = document.getElementById("typeNameX").value;
        const surname = document.getElementById("typeSurnameX").value;
        const username = document.getElementById("typeUsernameX").value;

        const userData = {
          uid: uid,
          email: email,
          name: name,
          surname: surname,
          username: username,
        };

        const btnRegister = document.getElementById("btnRegister");

        db.collection("Users")
          .doc(uid)
          .set(userData)
          .then(function () {
            console.log("Document successfully written!");
            alert("Veri başarıyla eklendi!");
            window.location.href = "index.html";
          })
          .catch(function (error) {
            console.error("Error adding document: ", error);
            alert("Veri eklenirken bir hata oluştu!");
            btnRegister.innerHTML = "Kayıtla Bakalım";
          });
      }

      // function addUser() {
      //   alert("Add user");
      //   const btnRegister = document.getElementById("btnRegister");

      //   db.collection("Users").add({
      //   })
      //   .then(function (docRef) {
      //     console.log("Document written with ID: ", docRef.id);
      //     // Veri başarıyla eklendiğinde kullanıcıya bilgi vermek için uygun bir mesaj görüntüleyebilirsiniz.
      //     alert("Veri başarıyla eklendi!");
      //     window.location.href = "index.html";
      //   })
      //   .catch(function (error) {
      //     console.error("Error adding document: ", error);
      //     // Hata durumunda kullanıcıya bilgi vermek için uygun bir mesaj görüntüleyebilirsiniz.
      //     alert("Veri eklenirken bir hata oluştu!");
      //     btnRegister.innerHTML='Kayıtla Bakalım';

      //   });
      // }
    </script>
  </body>
</html>
